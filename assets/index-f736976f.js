(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function c(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(e){if(e.ep)return;e.ep=!0;const t=c(e);fetch(e.href,t)}})();let u={},d=new Date;function L(){D(),M(),y(),v(),q(),m(),b()}function m(){let o=new Set,r=new Set,c=new Set,a=new Set;u.Events.forEach(n=>{o.add(n.startTime),r.add(n.duration),c.add(n.location),a.add(n.participants.join(","))});const e=document.querySelector("#filterStartTime"),t=document.querySelector("#filterDuration"),i=document.querySelector("#filterLocation"),l=document.querySelector("#filterParticipants");e.innerHTML='<option value="" class="startTime__listItem">Все</option>',t.innerHTML='<option value="" class="duration__listItem">Все</option>',i.innerHTML='<option value="" class="location__listItem">Все</option>',l.innerHTML='<option value="" class="participant__listItem">Все</option>',o.forEach(n=>{let s=`<option value="${n}" class="startTime__listItem">${n}</option>`;e.innerHTML+=s}),Array.from(r).sort((n,s)=>n-s).forEach(n=>{let s=`<option value="${n}" class="duration__listItem">${n}</option>`;t.innerHTML+=s}),c.forEach(n=>{let s=`<option value="${n}" class="location__listItem">${n}</option>`;i.innerHTML+=s}),a.forEach(n=>{let s=`<option value="${n}" class="participants__listItem">${n}</option>`;l.innerHTML+=s})}function T(){const o=document.querySelector("#filterStartTime"),r=document.querySelector("#filterDuration"),c=document.querySelector("#filterLocation"),a=document.querySelector("#filterParticipants");let e={Events:[]};return e.Events=u.Events.slice(0),e.Events=e.Events.filter(t=>o.value?t.startTime===o.value:!0),e.Events=e.Events.filter(t=>r.value?t.duration===r.value:!0),e.Events=e.Events.filter(t=>c.value?t.location===c.value:!0),e.Events=e.Events.filter(t=>a.value?t.participants.join(",")===a.value:!0),e.Events}function y(){const o=document.querySelector(".events__date");o.innerHTML=d.toLocaleString("ru-ru",{month:"long",day:"numeric",year:"numeric"})}function D(){localStorage.getItem("eventsList")?u=JSON.parse(localStorage.getItem("eventsList")):u={Events:[{title:"Соревнование по лёгкой атлетике",date:"2023-02-15",startTime:"14:30",duration:"4",location:"Бауманская",participants:["Тренер","Мартышка"]},{title:"Воллейбол",date:"2023-02-16",startTime:"12:30",duration:"1",location:"Сокольники",participants:["Саня","Яна"]}]}}function S(){localStorage.setItem("eventsList",JSON.stringify(u))}function v(){let o=T(),r={Events:[]};o.forEach(a=>{let e=new Date(a.date);d.getDate()===e.getDate()&&d.getMonth()===e.getMonth()&&d.getFullYear()===e.getFullYear()&&r.Events.push(a)});const c=document.querySelector(".events__list");c.innerHTML="",r.Events.forEach(a=>{let e=`<article class="events_listItem eventItem"><div class="eventItem__controlBlock"><span class="eventItem__controlItem btn btn--save collapse"></span><span class="eventItem__controlItem btn btn--edit"></span>
      <span class="eventItem__controlItem btn btn--del"></span>
      </div>
    <p class="eventItem__title">${a.title}</p>                                                             
    <div class="eventItem__row">                                                                                                
    <span class="eventItem__startTime">Время начала: <span class="eventItem__startTimeSpan">${a.startTime}</span></span>                      
    <span class="eventItem__duration">\\ Длительность: <span class="eventItem__durationSpan">${a.duration}</span></span>              
    </div>                                                                                                                      
    <p class="eventItem__location">Место: <span class="eventItem__locationSpan">${a.location}</span></p>                               
    <p class="eventItem__participants">Участники: 
    <span class="eventItem__participantsSpan">${a.participants.join(",")}</span></p></article>`;c.innerHTML+=e}),I(r)}function I(o){const r=document.querySelectorAll(".btn--edit"),c=document.querySelectorAll(".btn--del"),a=document.querySelectorAll(".btn--save");c.forEach((e,t)=>{e.addEventListener("click",i=>{i.target.parentElement.parentElement.remove(),u.Events.forEach((l,n)=>{JSON.stringify(l)===JSON.stringify(o.Events[t])&&(u.Events.splice(n,1),S(),m(),v())})})}),r.forEach((e,t)=>{e.addEventListener("click",i=>{i.preventDefault(),e.classList.add("collapse"),a[t].classList.remove("collapse");let l=i.target.parentElement.parentElement,n=l.querySelector(".eventItem__title"),s=l.querySelector(".eventItem__startTimeSpan"),f=l.querySelector(".eventItem__durationSpan"),E=l.querySelector(".eventItem__locationSpan"),_=l.querySelector(".eventItem__participantsSpan");n.innerHTML=`<input type="text" value="${n.textContent}">`,s.innerHTML=`<input type="time" value="${s.textContent}">`,f.innerHTML=`<input type="text" value="${f.textContent}">`,E.innerHTML=`<input type="text" value="${E.textContent}">`,_.innerHTML=`<input type="text" value="${_.textContent}">`,a[t].addEventListener("click",h=>{h.preventDefault(),u.Events.forEach((g,p)=>{JSON.stringify(g)===JSON.stringify(o.Events[t])&&(u.Events[p].title=n.children[0].value,u.Events[p].startTime=s.children[0].value,u.Events[p].duration=f.children[0].value,u.Events[p].location=E.children[0].value,u.Events[p].participants=_.children[0].value.split(","),S(),m(),v())})})})})}function q(){function o(){document.querySelector(".filters__wrapper").addEventListener("change",()=>{v()})}o()}function b(){const o=document.querySelector(".events__addButton"),r=document.querySelector(".events__addPopup");o.addEventListener("click",()=>{r.classList.toggle("collapse")}),document.querySelector(".addEventPopup__form").addEventListener("submit",a=>{const e=document.querySelector("#event-title"),t=document.querySelector("#event-date"),i=document.querySelector("#event-startTime"),l=document.querySelector("#event-duration"),n=document.querySelector("#event-location"),s=document.querySelector("#event-participants");a.preventDefault(),u.Events.push({title:e.value,date:t.value,startTime:i.value,duration:l.value,location:n.value,participants:s.value.split(",")}),S(),m(),v()})}function M(){function o(){const a=document.querySelector("#calendar");let e=new Date(new Date().getFullYear(),new Date().getMonth());const t=new Date().getDate(),i=e.getMonth();let l="<table class='calendar__table table table-bordered JS-calendar'><thead><th>пн</th><th>вт</th><th>ср</th><th>чт</th><th>пт</th><th>сб</th><th>вс</th></thead><tr>";for(let n=1;n<e.getDay();n++)l+="<td></td>";for(;e.getMonth()===i;)e.getDate()===t?l+="<td class='table-active'>"+e.getDate()+"</td>":l+="<td>"+e.getDate()+"</td>",e.getDay()%7===0&&(l+="</tr><tr>"),e.setDate(e.getDate()+1);if(e.getDay()!==0)for(let n=e.getDay();n<=7;n++)l+="<td></td>";l+="</tr></table>",a.innerHTML=l}function r(a){const e=a.currentTarget.querySelectorAll("td"),t=a.target.textContent;d=new Date(new Date().setDate(t)),e.forEach(i=>i.classList.remove("table-active")),t&&a.target.tagName==="TD"&&a.target.classList.add("table-active"),console.log(d),y(),v()}o(),document.querySelector(".JS-calendar").addEventListener("click",r)}L();
