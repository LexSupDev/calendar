(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))c(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&c(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerpolicy&&(l.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?l.credentials="include":i.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(i){if(i.ep)return;i.ep=!0;const l=s(i);fetch(i.href,l)}})();function _(n){let t=new Set,s=new Set,c=new Set,i=new Set;n.Events.forEach(e=>{t.add(e.startTime),s.add(e.duration),c.add(e.location),i.add(e.participants.join(","))});const l=document.querySelector("#filterStartTime"),a=document.querySelector("#filterDuration"),r=document.querySelector("#filterLocation"),u=document.querySelector("#filterParticipants");l.innerHTML='<option value="" class="startTime__listItem">Все</option>',a.innerHTML='<option value="" class="duration__listItem">Все</option>',r.innerHTML='<option value="" class="location__listItem">Все</option>',u.innerHTML='<option value="" class="participant__listItem">Все</option>',t.forEach(e=>{let o=`<option value="${e}" class="startTime__listItem">${e}</option>`;l.innerHTML+=o}),Array.from(s).sort((e,o)=>e-o).forEach(e=>{let o=`<option value="${e}" class="duration__listItem">${e}</option>`;a.innerHTML+=o}),c.forEach(e=>{let o=`<option value="${e}" class="location__listItem">${e}</option>`;r.innerHTML+=o}),i.forEach(e=>{let o=`<option value="${e}" class="participants__listItem">${e}</option>`;u.innerHTML+=o})}function I(n){const t=document.querySelector("#filterStartTime"),s=document.querySelector("#filterDuration"),c=document.querySelector("#filterLocation"),i=document.querySelector("#filterParticipants"),l=e(t,"startTime"),a=e(s,"duration"),r=e(i,"participants"),u=e(c,"location");function e(p,m){return function(v){return p.value?typeof v[m]=="object"?v[m].join(",")===p.value:v[m]===p.value:!0}}let o=d();function d(){return{Events:n.Events.slice(0).filter(l).filter(a).filter(u).filter(r)}}return o.Events}function g(n,t){document.querySelector(".filters__wrapper").addEventListener("change",()=>{f(n,t)})}function q(){return localStorage.getItem("eventsList")?JSON.parse(localStorage.getItem("eventsList")):{Events:[{title:"Соревнование по лёгкой атлетике",date:"2023-03-15",startTime:"14:30",duration:"4",location:"Бауманская",participants:["Тренер","Мартышка"]},{title:"Воллейбол",date:"2023-03-16",startTime:"12:30",duration:"1",location:"Сокольники",participants:["Саня","Яна"]}]}}function S(n){localStorage.setItem("eventsList",JSON.stringify(n))}function h(n){const t=document.querySelector(".events__date");t.innerHTML=n.toLocaleString("ru-ru",{month:"long",day:"numeric",year:"numeric"})}function f(n,t){let s=I(n),c={Events:[]};s.forEach(l=>{let a=new Date(l.date);t.getDate()===a.getDate()&&t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear()&&c.Events.push(l)});const i=document.querySelector(".events__list");i.innerHTML="",c.Events.forEach(l=>{let a=`<article class="events_listItem eventItem"><div class="eventItem__controlBlock"><span class="eventItem__controlItem btn btn--save collapse"></span><span class="eventItem__controlItem btn btn--edit"></span>
      <span class="eventItem__controlItem btn btn--del"></span>
      </div>
    <p class="eventItem__title">${l.title}</p>                                                             
    <div class="eventItem__row">                                                                                                
    <span class="eventItem__startTime">Время начала: <span class="eventItem__startTimeSpan">${l.startTime}</span></span>                      
    <span class="eventItem__duration">\\ Длительность: <span class="eventItem__durationSpan">${l.duration}</span></span>              
    </div>                                                                                                                      
    <p class="eventItem__location">Место: <span class="eventItem__locationSpan">${l.location}</span></p>                               
    <p class="eventItem__participants">Участники: 
    <span class="eventItem__participantsSpan">${l.participants.join(",")}</span></p></article>`;i.innerHTML+=a}),L(c,n,t)}function L(n,t,s){const c=document.querySelectorAll(".btn--edit"),i=document.querySelectorAll(".btn--del"),l=document.querySelectorAll(".btn--save");i.forEach((a,r)=>{a.addEventListener("click",u=>{u.target.parentElement.parentElement.remove(),t.Events.forEach((e,o)=>{JSON.stringify(e)===JSON.stringify(n.Events[r])&&(t.Events.splice(o,1),S(t),_(t),y(t,s),f(t,s))})})}),c.forEach((a,r)=>{a.addEventListener("click",u=>{u.preventDefault(),a.classList.add("collapse"),l[r].classList.remove("collapse");let e=u.target.parentElement.parentElement,o=e.querySelector(".eventItem__title"),d=e.querySelector(".eventItem__startTimeSpan"),p=e.querySelector(".eventItem__durationSpan"),m=e.querySelector(".eventItem__locationSpan"),v=e.querySelector(".eventItem__participantsSpan");o.innerHTML=`<input type="text" value="${o.textContent}">`,d.innerHTML=`<input type="time" value="${d.textContent}">`,p.innerHTML=`<input type="text" value="${p.textContent}">`,m.innerHTML=`<input type="text" value="${m.textContent}">`,v.innerHTML=`<input type="text" value="${v.textContent}">`,l[r].addEventListener("click",T=>{T.preventDefault(),t.Events.forEach((D,E)=>{JSON.stringify(D)===JSON.stringify(n.Events[r])&&(t.Events[E].title=o.children[0].value,t.Events[E].startTime=d.children[0].value,t.Events[E].duration=p.children[0].value,t.Events[E].location=m.children[0].value,t.Events[E].participants=v.children[0].value.split(","),S(t),_(t),y(t,s),f(t,s))})})})})}function M(n,t){const s=document.querySelector(".events__addButton"),c=document.querySelector(".events__addPopup");s.addEventListener("click",()=>{c.classList.toggle("collapse")}),document.querySelector(".addEventPopup__form").addEventListener("submit",l=>{const a=document.querySelector("#event-title"),r=document.querySelector("#event-date"),u=document.querySelector("#event-startTime"),e=document.querySelector("#event-duration"),o=document.querySelector("#event-location"),d=document.querySelector("#event-participants");l.preventDefault(),n.Events.push({title:a.value,date:r.value,startTime:u.value,duration:e.value,location:o.value,participants:d.value.split(",")}),S(n),_(n),y(n,t),f(n,t)})}function y(n,t){function s(){const a=document.querySelector("#calendar");let r=new Date(new Date().getFullYear(),new Date().getMonth());const u=new Date().getDate(),e=r.getMonth();let o="<table class='calendar__table table table-bordered JS-calendar'><thead><th>пн</th><th>вт</th><th>ср</th><th>чт</th><th>пт</th><th>сб</th><th>вс</th></thead><tr>";for(let d=1;d<r.getDay();d++)o+="<td></td>";for(;r.getMonth()===e;)c(r,n)&&r.getDate()===u?o+="<td class='table-active has-event'>"+r.getDate()+"</td>":r.getDate()===u?o+="<td class='table-active'>"+r.getDate()+"</td>":c(r,n)?o+="<td class='has-event'>"+r.getDate()+"</td>":o+="<td>"+r.getDate()+"</td>",r.getDay()%7===0&&(o+="</tr><tr>"),r.setDate(r.getDate()+1);if(r.getDay()!==0)for(let d=r.getDay();d<=7;d++)o+="<td></td>";o+="</tr></table>",a.innerHTML=o}function c(a,r){return!!r.Events.filter(e=>new Date(e.date).getDate()===a.getDate()&&new Date(e.date).getMonth()===a.getMonth()&&new Date(e.date).getFullYear()===a.getFullYear()).length}function i(a){const r=a.currentTarget.querySelectorAll("td"),u=a.target.textContent;t=new Date(new Date().setDate(u)),r.forEach(e=>e.classList.remove("table-active")),u&&a.target.tagName==="TD"&&a.target.classList.add("table-active"),h(t),f(n,t)}s(),document.querySelector(".JS-calendar").addEventListener("click",i)}function w(){let n=q(),t=new Date;y(n,t),h(t),f(n,t),g(n,t),_(n),M(n,t),g(n,t),S(n)}w();
