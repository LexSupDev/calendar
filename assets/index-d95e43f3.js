(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const a of e.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function u(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?e.credentials="include":t.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function l(t){if(t.ep)return;t.ep=!0;const e=u(t);fetch(t.href,e)}})();let c={},p=new Date;function T(){q(),y(),L(),m(),h(),S(),M(),h()}function S(){let s=new Set,o=new Set,u=new Set,l=new Set;c.Events.forEach(n=>{s.add(n.startTime),o.add(n.duration),u.add(n.location),l.add(n.participants.join(","))});const t=document.querySelector("#filterStartTime"),e=document.querySelector("#filterDuration"),a=document.querySelector("#filterLocation"),i=document.querySelector("#filterParticipants");t.innerHTML='<option value="" class="startTime__listItem">Все</option>',e.innerHTML='<option value="" class="duration__listItem">Все</option>',a.innerHTML='<option value="" class="location__listItem">Все</option>',i.innerHTML='<option value="" class="participant__listItem">Все</option>',s.forEach(n=>{let r=`<option value="${n}" class="startTime__listItem">${n}</option>`;t.innerHTML+=r}),Array.from(o).sort((n,r)=>n-r).forEach(n=>{let r=`<option value="${n}" class="duration__listItem">${n}</option>`;e.innerHTML+=r}),u.forEach(n=>{let r=`<option value="${n}" class="location__listItem">${n}</option>`;a.innerHTML+=r}),l.forEach(n=>{let r=`<option value="${n}" class="participants__listItem">${n}</option>`;i.innerHTML+=r})}function I(){const s=document.querySelector("#filterStartTime"),o=document.querySelector("#filterDuration"),u=document.querySelector("#filterLocation"),l=document.querySelector("#filterParticipants"),t=n(s,"startTime"),e=n(o,"duration"),a=n(l,"participants"),i=n(u,"location");function n(d,v){return function(E){return d.value?typeof E[v]=="object"?E[v].join(",")===d.value:E[v]===d.value:!0}}let r=f();function f(){return{Events:c.Events.slice(0).filter(t).filter(e).filter(i).filter(a)}}return r.Events}function L(){const s=document.querySelector(".events__date");s.innerHTML=p.toLocaleString("ru-ru",{month:"long",day:"numeric",year:"numeric"})}function q(){localStorage.getItem("eventsList")?c=JSON.parse(localStorage.getItem("eventsList")):c={Events:[{title:"Соревнование по лёгкой атлетике",date:"2023-02-15",startTime:"14:30",duration:"4",location:"Бауманская",participants:["Тренер","Мартышка"]},{title:"Воллейбол",date:"2023-02-16",startTime:"12:30",duration:"1",location:"Сокольники",participants:["Саня","Яна"]}]}}function g(){localStorage.setItem("eventsList",JSON.stringify(c))}function m(){let s=I(),o={Events:[]};s.forEach(l=>{let t=new Date(l.date);p.getDate()===t.getDate()&&p.getMonth()===t.getMonth()&&p.getFullYear()===t.getFullYear()&&o.Events.push(l)});const u=document.querySelector(".events__list");u.innerHTML="",o.Events.forEach(l=>{let t=`<article class="events_listItem eventItem"><div class="eventItem__controlBlock"><span class="eventItem__controlItem btn btn--save collapse"></span><span class="eventItem__controlItem btn btn--edit"></span>
      <span class="eventItem__controlItem btn btn--del"></span>
      </div>
    <p class="eventItem__title">${l.title}</p>                                                             
    <div class="eventItem__row">                                                                                                
    <span class="eventItem__startTime">Время начала: <span class="eventItem__startTimeSpan">${l.startTime}</span></span>                      
    <span class="eventItem__duration">\\ Длительность: <span class="eventItem__durationSpan">${l.duration}</span></span>              
    </div>                                                                                                                      
    <p class="eventItem__location">Место: <span class="eventItem__locationSpan">${l.location}</span></p>                               
    <p class="eventItem__participants">Участники: 
    <span class="eventItem__participantsSpan">${l.participants.join(",")}</span></p></article>`;u.innerHTML+=t}),b(o)}function b(s){const o=document.querySelectorAll(".btn--edit"),u=document.querySelectorAll(".btn--del"),l=document.querySelectorAll(".btn--save");u.forEach((t,e)=>{t.addEventListener("click",a=>{a.target.parentElement.parentElement.remove(),c.Events.forEach((i,n)=>{JSON.stringify(i)===JSON.stringify(s.Events[e])&&(c.Events.splice(n,1),g(),S(),y(),m())})})}),o.forEach((t,e)=>{t.addEventListener("click",a=>{a.preventDefault(),t.classList.add("collapse"),l[e].classList.remove("collapse");let i=a.target.parentElement.parentElement,n=i.querySelector(".eventItem__title"),r=i.querySelector(".eventItem__startTimeSpan"),f=i.querySelector(".eventItem__durationSpan"),d=i.querySelector(".eventItem__locationSpan"),v=i.querySelector(".eventItem__participantsSpan");n.innerHTML=`<input type="text" value="${n.textContent}">`,r.innerHTML=`<input type="time" value="${r.textContent}">`,f.innerHTML=`<input type="text" value="${f.textContent}">`,d.innerHTML=`<input type="text" value="${d.textContent}">`,v.innerHTML=`<input type="text" value="${v.textContent}">`,l[e].addEventListener("click",E=>{E.preventDefault(),c.Events.forEach((D,_)=>{JSON.stringify(D)===JSON.stringify(s.Events[e])&&(c.Events[_].title=n.children[0].value,c.Events[_].startTime=r.children[0].value,c.Events[_].duration=f.children[0].value,c.Events[_].location=d.children[0].value,c.Events[_].participants=v.children[0].value.split(","),g(),S(),y(),m())})})})})}function h(){document.querySelector(".filters__wrapper").addEventListener("change",()=>{m()})}function M(){const s=document.querySelector(".events__addButton"),o=document.querySelector(".events__addPopup");s.addEventListener("click",()=>{o.classList.toggle("collapse")}),document.querySelector(".addEventPopup__form").addEventListener("submit",l=>{const t=document.querySelector("#event-title"),e=document.querySelector("#event-date"),a=document.querySelector("#event-startTime"),i=document.querySelector("#event-duration"),n=document.querySelector("#event-location"),r=document.querySelector("#event-participants");l.preventDefault(),c.Events.push({title:t.value,date:e.value,startTime:a.value,duration:i.value,location:n.value,participants:r.value.split(",")}),g(),S(),y(),m()})}function y(){function s(){const t=document.querySelector("#calendar");let e=new Date(new Date().getFullYear(),new Date().getMonth());const a=new Date().getDate(),i=e.getMonth();let n="<table class='calendar__table table table-bordered JS-calendar'><thead><th>пн</th><th>вт</th><th>ср</th><th>чт</th><th>пт</th><th>сб</th><th>вс</th></thead><tr>";for(let r=1;r<e.getDay();r++)n+="<td></td>";for(;e.getMonth()===i;)o(e)&&e.getDate()===a?n+="<td class='table-active has-event'>"+e.getDate()+"</td>":e.getDate()===a?n+="<td class='table-active'>"+e.getDate()+"</td>":o(e)?n+="<td class='has-event'>"+e.getDate()+"</td>":n+="<td>"+e.getDate()+"</td>",e.getDay()%7===0&&(n+="</tr><tr>"),e.setDate(e.getDate()+1);if(e.getDay()!==0)for(let r=e.getDay();r<=7;r++)n+="<td></td>";n+="</tr></table>",t.innerHTML=n}function o(t){return!!c.Events.filter(a=>new Date(a.date).getDate()===t.getDate()&&new Date(a.date).getMonth()===t.getMonth()&&new Date(a.date).getFullYear()===t.getFullYear()).length}function u(t){const e=t.currentTarget.querySelectorAll("td"),a=t.target.textContent;p=new Date(new Date().setDate(a)),e.forEach(i=>i.classList.remove("table-active")),a&&t.target.tagName==="TD"&&t.target.classList.add("table-active"),console.log(p),L(),m()}s(),document.querySelector(".JS-calendar").addEventListener("click",u)}T();
