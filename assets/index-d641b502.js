(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function u(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(t){if(t.ep)return;t.ep=!0;const n=u(t);fetch(t.href,n)}})();let c={},v=new Date;function T(){I(),M(),g(),m(),h(),S(),b(),h()}function S(){let i=new Set,l=new Set,u=new Set,a=new Set;c.Events.forEach(e=>{i.add(e.startTime),l.add(e.duration),u.add(e.location),a.add(e.participants.join(","))});const t=document.querySelector("#filterStartTime"),n=document.querySelector("#filterDuration"),o=document.querySelector("#filterLocation"),r=document.querySelector("#filterParticipants");t.innerHTML='<option value="" class="startTime__listItem">Все</option>',n.innerHTML='<option value="" class="duration__listItem">Все</option>',o.innerHTML='<option value="" class="location__listItem">Все</option>',r.innerHTML='<option value="" class="participant__listItem">Все</option>',i.forEach(e=>{let s=`<option value="${e}" class="startTime__listItem">${e}</option>`;t.innerHTML+=s}),Array.from(l).sort((e,s)=>e-s).forEach(e=>{let s=`<option value="${e}" class="duration__listItem">${e}</option>`;n.innerHTML+=s}),u.forEach(e=>{let s=`<option value="${e}" class="location__listItem">${e}</option>`;o.innerHTML+=s}),a.forEach(e=>{let s=`<option value="${e}" class="participants__listItem">${e}</option>`;r.innerHTML+=s})}function D(){const i=document.querySelector("#filterStartTime"),l=document.querySelector("#filterDuration"),u=document.querySelector("#filterLocation"),a=document.querySelector("#filterParticipants"),t=e(i,"startTime"),n=e(l,"duration"),o=e(a,"participants"),r=e(u,"location");function e(d,p){return function(E){return d.value?typeof E[p]=="object"?E[p].join(",")===d.value:E[p]===d.value:!0}}let s=f();function f(){return{Events:c.Events.slice(0).filter(t).filter(n).filter(r).filter(o)}}return s.Events}function g(){const i=document.querySelector(".events__date");i.innerHTML=v.toLocaleString("ru-ru",{month:"long",day:"numeric",year:"numeric"})}function I(){localStorage.getItem("eventsList")?c=JSON.parse(localStorage.getItem("eventsList")):c={Events:[{title:"Соревнование по лёгкой атлетике",date:"2023-02-15",startTime:"14:30",duration:"4",location:"Бауманская",participants:["Тренер","Мартышка"]},{title:"Воллейбол",date:"2023-02-16",startTime:"12:30",duration:"1",location:"Сокольники",participants:["Саня","Яна"]}]}}function y(){localStorage.setItem("eventsList",JSON.stringify(c))}function m(){let i=D(),l={Events:[]};i.forEach(a=>{let t=new Date(a.date);v.getDate()===t.getDate()&&v.getMonth()===t.getMonth()&&v.getFullYear()===t.getFullYear()&&l.Events.push(a)});const u=document.querySelector(".events__list");u.innerHTML="",l.Events.forEach(a=>{let t=`<article class="events_listItem eventItem"><div class="eventItem__controlBlock"><span class="eventItem__controlItem btn btn--save collapse"></span><span class="eventItem__controlItem btn btn--edit"></span>
      <span class="eventItem__controlItem btn btn--del"></span>
      </div>
    <p class="eventItem__title">${a.title}</p>                                                             
    <div class="eventItem__row">                                                                                                
    <span class="eventItem__startTime">Время начала: <span class="eventItem__startTimeSpan">${a.startTime}</span></span>                      
    <span class="eventItem__duration">\\ Длительность: <span class="eventItem__durationSpan">${a.duration}</span></span>              
    </div>                                                                                                                      
    <p class="eventItem__location">Место: <span class="eventItem__locationSpan">${a.location}</span></p>                               
    <p class="eventItem__participants">Участники: 
    <span class="eventItem__participantsSpan">${a.participants.join(",")}</span></p></article>`;u.innerHTML+=t}),q(l)}function q(i){const l=document.querySelectorAll(".btn--edit"),u=document.querySelectorAll(".btn--del"),a=document.querySelectorAll(".btn--save");u.forEach((t,n)=>{t.addEventListener("click",o=>{o.target.parentElement.parentElement.remove(),c.Events.forEach((r,e)=>{JSON.stringify(r)===JSON.stringify(i.Events[n])&&(c.Events.splice(e,1),y(),S(),m())})})}),l.forEach((t,n)=>{t.addEventListener("click",o=>{o.preventDefault(),t.classList.add("collapse"),a[n].classList.remove("collapse");let r=o.target.parentElement.parentElement,e=r.querySelector(".eventItem__title"),s=r.querySelector(".eventItem__startTimeSpan"),f=r.querySelector(".eventItem__durationSpan"),d=r.querySelector(".eventItem__locationSpan"),p=r.querySelector(".eventItem__participantsSpan");e.innerHTML=`<input type="text" value="${e.textContent}">`,s.innerHTML=`<input type="time" value="${s.textContent}">`,f.innerHTML=`<input type="text" value="${f.textContent}">`,d.innerHTML=`<input type="text" value="${d.textContent}">`,p.innerHTML=`<input type="text" value="${p.textContent}">`,a[n].addEventListener("click",E=>{E.preventDefault(),c.Events.forEach((L,_)=>{JSON.stringify(L)===JSON.stringify(i.Events[n])&&(c.Events[_].title=e.children[0].value,c.Events[_].startTime=s.children[0].value,c.Events[_].duration=f.children[0].value,c.Events[_].location=d.children[0].value,c.Events[_].participants=p.children[0].value.split(","),y(),S(),m())})})})})}function h(){document.querySelector(".filters__wrapper").addEventListener("change",()=>{m()})}function b(){const i=document.querySelector(".events__addButton"),l=document.querySelector(".events__addPopup");i.addEventListener("click",()=>{l.classList.toggle("collapse")}),document.querySelector(".addEventPopup__form").addEventListener("submit",a=>{const t=document.querySelector("#event-title"),n=document.querySelector("#event-date"),o=document.querySelector("#event-startTime"),r=document.querySelector("#event-duration"),e=document.querySelector("#event-location"),s=document.querySelector("#event-participants");a.preventDefault(),c.Events.push({title:t.value,date:n.value,startTime:o.value,duration:r.value,location:e.value,participants:s.value.split(",")}),y(),S(),m()})}function M(){function i(){const a=document.querySelector("#calendar");let t=new Date(new Date().getFullYear(),new Date().getMonth());const n=new Date().getDate(),o=t.getMonth();let r="<table class='calendar__table table table-bordered JS-calendar'><thead><th>пн</th><th>вт</th><th>ср</th><th>чт</th><th>пт</th><th>сб</th><th>вс</th></thead><tr>";for(let e=1;e<t.getDay();e++)r+="<td></td>";for(;t.getMonth()===o;)t.getDate()===n?r+="<td class='table-active'>"+t.getDate()+"</td>":r+="<td>"+t.getDate()+"</td>",t.getDay()%7===0&&(r+="</tr><tr>"),t.setDate(t.getDate()+1);if(t.getDay()!==0)for(let e=t.getDay();e<=7;e++)r+="<td></td>";r+="</tr></table>",a.innerHTML=r}function l(a){const t=a.currentTarget.querySelectorAll("td"),n=a.target.textContent;v=new Date(new Date().setDate(n)),t.forEach(o=>o.classList.remove("table-active")),n&&a.target.tagName==="TD"&&a.target.classList.add("table-active"),console.log(v),g(),m()}i(),document.querySelector(".JS-calendar").addEventListener("click",l)}T();
