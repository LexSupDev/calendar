(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function i(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerpolicy&&(r.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?r.credentials="include":e.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(e){if(e.ep)return;e.ep=!0;const r=i(e);fetch(e.href,r)}})();function h(a){const t=document.querySelector("#filterStartTime"),i=document.querySelector("#filterDuration"),c=document.querySelector("#filterLocation"),e=document.querySelector("#filterParticipants");t.innerHTML='<option value="" class="startTime__listItem">Все</option>',i.innerHTML='<option value="" class="duration__listItem">Все</option>',c.innerHTML='<option value="" class="location__listItem">Все</option>',e.innerHTML='<option value="" class="participant__listItem">Все</option>';let r=new Set,l=new Set,n=new Set,s=new Set;a.Events.forEach(o=>{r.add(o.startTime),l.add(o.duration),n.add(o.location),s.add(o.participants.join(","))});function u(o,p,f){Array.from(o).sort((v,m)=>v-m).forEach(v=>{let m=`<option value="${v}" class=${f}>${v}</option>`;p.innerHTML+=m})}u(r,t,"startTime__listItem"),u(l,i,"duration__listItem"),u(n,c,"location__listItem"),u(s,e,"participants__listItem")}function L(a){const t=document.querySelector("#filterStartTime"),i=document.querySelector("#filterDuration"),c=document.querySelector("#filterLocation"),e=document.querySelector("#filterParticipants"),r=u(t,"startTime"),l=u(i,"duration"),n=u(e,"participants"),s=u(c,"location");function u(f,v){return function(m){return f.value?typeof m[v]=="object"?m[v].join(",")===f.value:m[v]===f.value:!0}}function o(){return{Events:a.Events.slice(0).filter(r).filter(l).filter(s).filter(n)}}return o().Events}function w(a){document.querySelector(".filters__wrapper").addEventListener("change",()=>{_(a,d.activeDate)})}function M(){return localStorage.getItem("eventsList")?JSON.parse(localStorage.getItem("eventsList")):{Events:[{title:"Соревнование по лёгкой атлетике",date:"2023-03-15",startTime:"14:30",duration:"4",location:"Бауманская",participants:["Тренер","Мартышка"]},{title:"Воллейбол",date:"2023-03-16",startTime:"12:30",duration:"1",location:"Сокольники",participants:["Саня","Яна"]}]}}function y(a){localStorage.setItem("eventsList",JSON.stringify(a))}function T(a){const t=document.querySelector(".events__date");t.innerHTML=a.toLocaleString("ru-RU",{month:"long",day:"numeric",year:"numeric"})}function E(a,t){let i={Events:[]};return a.forEach(c=>{let e=new Date(c.date);t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()&&i.Events.push(c)}),i}function _(a,t){let i=L(a),c=E(i,t);const e=document.querySelector(".events__list");e.innerHTML="",c.Events.forEach(r=>{let l=`<article class="events_listItem eventItem"><div class="eventItem__controlBlock"><span class="eventItem__controlItem btn btn--save collapse"></span><span class="eventItem__controlItem btn btn--edit"></span>
      <span class="eventItem__controlItem btn btn--del"></span>
      </div>
    <p class="eventItem__title">${r.title}</p>                                                             
    <div class="eventItem__row">                                                                                                
    <span class="eventItem__startTime">Время начала: <span class="eventItem__startTimeSpan">${r.startTime}</span></span>                      
    <span class="eventItem__duration">\\ Длительность: <span class="eventItem__durationSpan">${r.duration}</span></span>              
    </div>                                                                                                                      
    <p class="eventItem__location">Место: <span class="eventItem__locationSpan">${r.location}</span></p>                               
    <p class="eventItem__participants">Участники: 
    <span class="eventItem__participantsSpan">${r.participants.join(",")}</span></p></article>`;e.innerHTML+=l}),F(c,a,t)}function F(a,t,i){const c=document.querySelectorAll(".btn--edit"),e=document.querySelectorAll(".btn--del"),r=document.querySelectorAll(".btn--save");function l(n,s){return n.title===s.title&&n.date===s.date&&n.startTime===s.startTime&&n.duration===s.duration&&n.location===s.location&&n.participants===s.participants}e.forEach((n,s)=>{n.addEventListener("click",()=>{let u=0;t.Events.forEach((o,p)=>{if(l(o,a.Events[s]))for(;u<1;)u++,t.Events.splice(p,1),y(t),d(t,i),_(t,i),h(E(t.Events,d.activeDate))})})}),c.forEach((n,s)=>{n.addEventListener("click",u=>{u.preventDefault(),n.classList.add("collapse"),r[s].classList.remove("collapse");let o=u.target.parentElement.parentElement,p=o.querySelector(".eventItem__title"),f=o.querySelector(".eventItem__startTimeSpan"),v=o.querySelector(".eventItem__durationSpan"),m=o.querySelector(".eventItem__locationSpan"),g=o.querySelector(".eventItem__participantsSpan");p.innerHTML=`<input type="text" value="${p.textContent}">`,f.innerHTML=`<input type="time" value="${f.textContent}">`,v.innerHTML=`<input type="text" value="${v.textContent}">`,m.innerHTML=`<input type="text" value="${m.textContent}">`,g.innerHTML=`<input type="text" value="${g.textContent}">`,r[s].addEventListener("click",I=>{I.preventDefault();let D=0;t.Events.forEach((q,S)=>{if(l(q,a.Events[s]))for(;D<1;)D++,t.Events[S].title=p.children[0].value,t.Events[S].startTime=f.children[0].value,t.Events[S].duration=v.children[0].value,t.Events[S].location=m.children[0].value,t.Events[S].participants=g.children[0].value.split(","),y(t),d(t,i),_(t,i),h(E(t.Events,d.activeDate))})})})})}function H(){function a(){const i=document.querySelector(".events__addPopup");i.classList.contains("collapse")?i.classList.remove("collapse"):i.classList.add("collapse")}document.querySelector(".events__addButton").addEventListener("click",a)}function P(a){const t=document.querySelector("#event-title"),i=document.querySelector("#event-date"),c=document.querySelector("#event-startTime"),e=document.querySelector("#event-duration"),r=document.querySelector("#event-location"),l=document.querySelector("#event-participants");a.Events.push({title:t.value,date:i.value,startTime:c.value,duration:e.value,location:r.value,participants:l.value.split(",")})}function $(a){function t(c,e,r){c.preventDefault(),P(e),y(e),h(E(e.Events,d.activeDate)),d(e,r),_(e,r)}document.querySelector(".addEventPopup__form").addEventListener("submit",c=>{t(c,a,d.activeDate)})}function d(a,t){function i(){const l=document.querySelector("#calendar");let n=new Date(new Date().getFullYear(),new Date().getMonth());const s=t.getDate(),u=n.getMonth();let o="<table class='calendar__table table table-bordered JS-calendar'><thead><th>пн</th><th>вт</th><th>ср</th><th>чт</th><th>пт</th><th>сб</th><th>вс</th></thead><tr>";for(let p=1;p<n.getDay();p++)o+="<td></td>";for(;n.getMonth()===u;)c(n,a)&&n.getDate()===s?o+="<td class='table-active has-event'>"+n.getDate()+"</td>":n.getDate()===s?o+="<td class='table-active'>"+n.getDate()+"</td>":c(n,a)?o+="<td class='has-event'>"+n.getDate()+"</td>":o+="<td>"+n.getDate()+"</td>",n.getDay()%7===0&&(o+="</tr><tr>"),n.setDate(n.getDate()+1);if(n.getDay()!==0)for(let p=n.getDay();p<=7;p++)o+="<td></td>";o+="</tr></table>",l.innerHTML=o}function c(l,n){return!!n.Events.filter(u=>new Date(u.date).getDate()===l.getDate()&&new Date(u.date).getMonth()===l.getMonth()&&new Date(u.date).getFullYear()===l.getFullYear()).length}function e(l){const n=l.currentTarget.querySelectorAll("td"),s=l.target.textContent;t=new Date(new Date().setDate(s)),d.activeDate=t,n.forEach(u=>u.classList.remove("table-active")),s&&l.target.tagName==="TD"&&l.target.classList.add("table-active"),T(t),_(a,t),h(E(a.Events,d.activeDate))}i(),document.querySelector(".JS-calendar").addEventListener("click",e)}function A(){let a=M();d.activeDate=new Date,d(a,d.activeDate),w(a),H(),$(a),_(a,d.activeDate),h(E(a.Events,d.activeDate)),T(d.activeDate),y(a)}A();
